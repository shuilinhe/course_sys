{"remainingRequest":"D:\\code\\zhuanyezonghesheji\\Combine_4\\Combine_1\\course-sys\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\zhuanyezonghesheji\\Combine_4\\Combine_1\\course-sys\\src\\views\\SupervisorView\\Supervisor.vue?vue&type=style&index=0&id=201b2c5a&prod&scoped=true&lang=css&","dependencies":[{"path":"D:\\code\\zhuanyezonghesheji\\Combine_4\\Combine_1\\course-sys\\src\\views\\SupervisorView\\Supervisor.vue","mtime":1670768330000},{"path":"D:\\code\\zhuanyezonghesheji\\Combine_4\\Combine_1\\course-sys\\node_modules\\css-loader\\dist\\cjs.js","mtime":1667012056000},{"path":"D:\\code\\zhuanyezonghesheji\\Combine_4\\Combine_1\\course-sys\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1667012058000},{"path":"D:\\code\\zhuanyezonghesheji\\Combine_4\\Combine_1\\course-sys\\node_modules\\postcss-loader\\src\\index.js","mtime":1667012056000},{"path":"D:\\code\\zhuanyezonghesheji\\Combine_4\\Combine_1\\course-sys\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667012054000},{"path":"D:\\code\\zhuanyezonghesheji\\Combine_4\\Combine_1\\course-sys\\node_modules\\vue-loader\\lib\\index.js","mtime":1667012058000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouYmlnQ29udGFpbmVyIHsNCiAgaGVpZ2h0OiA2NzBweDsNCn0NCi5lbC10YWJlbCwNCi5lbC10YWJlbC1jb2x1bW4gew0KICBsaW5lLWhlaWdodDogNzBweDsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KfQ0KLmVsLWlucHV0IHsNCiAgbWFyZ2luLXJpZ2h0OiAxMHB4Ow0KfQ0KLnN1cF90YWcgew0KICBmb250LXNpemU6IDIwcHg7DQp9DQo="},{"version":3,"sources":["Supervisor.vue"],"names":[],"mappings":";AAkZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Supervisor.vue","sourceRoot":"src/views/SupervisorView","sourcesContent":["<template>\r\n  <div>\r\n    <el-card class=\"box-card\" style=\"height: 762px\">\r\n      <div class=\"top\">\r\n        <el-input\r\n          placeholder=\"请输入督导姓名\"\r\n          class=\"search-inp\"\r\n          v-model=\"queryInfo.name\"\r\n          style=\"width: 220px\"\r\n          clearable\r\n        />\r\n        <el-input\r\n          placeholder=\"请输入督导专业\"\r\n          class=\"search-inp\"\r\n          v-model=\"queryInfo.major\"\r\n          style=\"width: 220px\"\r\n          clearable\r\n        />\r\n        <el-button\r\n          icon=\"el-icon-search\"\r\n          type=\"primary\"\r\n          class=\"search_btn\"\r\n          @click=\"search\"\r\n          >搜索</el-button\r\n        >\r\n        <el-button\r\n          type=\"primary\"\r\n          class=\"add_btn\"\r\n          @click=\"addDialogVisible = true\"\r\n          ><i class=\"el-icon-plus\" id=\"add_img\"></i>添加</el-button\r\n        >\r\n        <el-button plain class=\"refresh_btn\" @click=\"reload\"\r\n          ><i class=\"el-icon-refresh-right\" id=\"refresh_img\"></i>刷新</el-button\r\n        >\r\n      </div>\r\n\r\n      <el-table\r\n        class=\"s_table\"\r\n        :data=\"supervisorlist\"\r\n        border\r\n        resizable=\"true\"\r\n        style=\"width: 100%\"\r\n        height=\"600px\"\r\n      >\r\n        <el-table-column\r\n          fixed\r\n          type=\"selection\"\r\n          align=\"center\"\r\n        ></el-table-column>\r\n        <el-table-column\r\n          prop=\"id\"\r\n          label=\"编号\"\r\n          align=\"center\"\r\n          v-if=\"false\"\r\n        ></el-table-column>\r\n        <el-table-column\r\n          fixed\r\n          prop=\"serialNumber\"\r\n          label=\"序号\"\r\n          align=\"center\"\r\n        ></el-table-column>\r\n\r\n        <el-table-column\r\n          prop=\"jobNumber\"\r\n          label=\"工号\"\r\n          align=\"center\"\r\n          width=\"200\"\r\n        >\r\n        </el-table-column>\r\n\r\n        <el-table-column prop=\"name\" label=\"姓名\" align=\"center\" width=\"200\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"major\" label=\"专业\" align=\"center\" width=\"200\">\r\n        </el-table-column>\r\n\r\n        <el-table-column prop=\"campus\" label=\"校区\" align=\"center\" width=\"200\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"remark\" label=\"备注\" align=\"center\" width=\"200\">\r\n        </el-table-column>\r\n\r\n        <el-table-column\r\n          label=\"操作\"\r\n          fixed=\"right\"\r\n          align=\"center\"\r\n          width=\"200px\"\r\n        >\r\n          <template slot-scope=\"scope\">\r\n            <el-button\r\n              icon=\"el-icon-edit\"\r\n              size=\"mini\"\r\n              type=\"primary\"\r\n              @click=\"showEditView(scope.row)\"\r\n              >修改</el-button\r\n            >\r\n            <el-button\r\n              icon=\"el-icon-delete\"\r\n              size=\"mini\"\r\n              type=\"danger\"\r\n              @click=\"handleDelete(scope.$index, scope.row)\"\r\n              >删除</el-button\r\n            >\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <div class=\"block\">\r\n        <el-pagination\r\n          @current-change=\"handleCurrentChange\"\r\n          :page-size=\"limit\"\r\n          :current-page=\"page\"\r\n          layout=\"total,prev, pager, next\"\r\n          :total=\"total\"\r\n        >\r\n        </el-pagination>\r\n      </div>\r\n      <el-dialog\r\n        title=\"修改督导信息\"\r\n        :visible.sync=\"updateDialogVisible\"\r\n        width=\"30%\"\r\n      >\r\n        <el-form\r\n          :rules=\"supervisor_rules\"\r\n          :model=\"supervisorForm\"\r\n          ref=\"supervisorForm\"\r\n          label-width=\"60px\"\r\n        >\r\n          <el-form-item prop=\"serialNumber\" label=\"序号:\">\r\n            <el-input v-model=\"supervisorForm.serialNumber\"></el-input>\r\n          </el-form-item>\r\n\r\n          <el-form-item prop=\"jobNumber\" label=\"工号:\">\r\n            <el-input v-model=\"supervisorForm.jobNumber\"></el-input>\r\n          </el-form-item>\r\n\r\n          <el-form-item prop=\"name\" label=\"姓名:\">\r\n            <el-input v-model=\"supervisorForm.name\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item prop=\"major\" label=\"专业:\">\r\n            <el-input v-model=\"supervisorForm.major\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item prop=\"campus\" label=\"校区:\">\r\n            <el-input\r\n              v-model=\"supervisorForm.campus\"\r\n              class=\"addSuperInput\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item prop=\"remark\" label=\"备注:\">\r\n            <el-input v-model=\"supervisorForm.remark\"></el-input>\r\n          </el-form-item>\r\n          <el-button @click=\"cancelUpdate\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"doUpdate\">确 定</el-button>\r\n        </el-form>\r\n      </el-dialog>\r\n\r\n      <el-dialog title=\"添加督导\" :visible.sync=\"addDialogVisible\" width=\"30%\">\r\n        <el-form\r\n          :rules=\"supervisor_rules\"\r\n          :model=\"supervisorForm\"\r\n          ref=\"supervisorForm\"\r\n          label-width=\"60px\"\r\n          size=\"medium\"\r\n        >\r\n          <el-form-item prop=\"serialNumber\" label=\"序号:\">\r\n            <el-input\r\n              v-model=\"supervisorForm.serialNumber\"\r\n              class=\"addSuperInput\"\r\n            ></el-input>\r\n          </el-form-item>\r\n\r\n          <el-form-item prop=\"jobNumber\" label=\"工号:\">\r\n            <el-input\r\n              v-model=\"supervisorForm.jobNumber\"\r\n              class=\"addSuperInput\"\r\n            ></el-input>\r\n          </el-form-item>\r\n\r\n          <el-form-item prop=\"name\" label=\"姓名:\">\r\n            <el-input\r\n              v-model=\"supervisorForm.name\"\r\n              class=\"addSuperInput\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item prop=\"major\" label=\"专业:\">\r\n            <el-input\r\n              v-model=\"supervisorForm.major\"\r\n              class=\"addSuperInput\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item prop=\"campus\" label=\"校区:\">\r\n            <el-input\r\n              v-model=\"supervisorForm.campus\"\r\n              class=\"addSuperInput\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item prop=\"remark\" label=\"备注:\">\r\n            <el-input\r\n              v-model=\"supervisorForm.remark\"\r\n              class=\"addSuperInput\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-button @click=\"cancelAdd\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"doAdd\">确 定</el-button>\r\n        </el-form>\r\n      </el-dialog>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n  \r\n  <script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      page: 1,\r\n      limit: 9,\r\n      id: \"\",\r\n      queryInfo: {\r\n        name: \"\",\r\n        major: \"\",\r\n      },\r\n      supervisorlist: [],\r\n      multipleSelection: [],\r\n      updateDialogVisible: false,\r\n      addDialogVisible: false,\r\n      supervisorForm: {\r\n        jobNumber: \"\",\r\n        major: \"\",\r\n        name: \"\",\r\n        remark: \"\",\r\n        campus: \"\",\r\n        serialNumber: \"\",\r\n      },\r\n      total: 0,\r\n      supervisor_rules: {\r\n        serialNumber: [\r\n          { required: true, message: \"请输入序号\", trigger: \"blur\" },\r\n        ],\r\n        jobNumber: [\r\n          { required: true, message: \"请输入督导的工号\", trigger: \"blur\" },\r\n        ],\r\n        name: [\r\n          { required: true, message: \"请输入督导的姓名\", trigger: \"blur\" },\r\n        ],\r\n        major: [\r\n          { required: true, message: \"请输入督导的专业\", trigger: \"blur\" },\r\n        ],\r\n        remark: [{ required: true, message: \"请输入备注\", trigger: \"blur\" }],\r\n      },\r\n    };\r\n  },\r\n  created() {\r\n    //初始化督导列表\r\n    this.getSupervisorList(this.page, this.limit, this.queryInfo);\r\n  },\r\n  methods: {\r\n    //功能1：搜索督导信息\r\n    async search(page, limit) {\r\n      page = 1;\r\n      limit = this.limit;\r\n      const { data: res } = await this.$http.post(\r\n        `/api/supervise/list/${page}/${limit}`,\r\n        this.queryInfo\r\n      );\r\n      this.supervisorlist = res.data.rows;\r\n      this.handleCurrentChange();\r\n    },\r\n    //添加督导信息表单验证\r\n    async doAdd(jobNumber) {\r\n      //提交添加请求前先检查\"工号\"是否存在\r\n      jobNumber = this.supervisorForm.jobNumber;\r\n      const { data: res } = await this.$http.get(`/api/supervise/exists`, {\r\n        params: {\r\n          jobNumber: jobNumber,\r\n        },\r\n      });\r\n      //\"工号\"存在\r\n      if (res.success == false) {\r\n        this.$message.error(res.message);\r\n      }\r\n      //\"工号\"不存在\r\n      else {\r\n        await this.$refs.supervisorForm\r\n          .validate()\r\n          .then(() => {\r\n            this.AddSupervisor();\r\n            this.supervisorForm = this.$options.data().supervisorForm;\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n            this.$message.error(\"请填写完整的信息\");\r\n          });\r\n      }\r\n    },\r\n    //功能2：添加督导信息\r\n    async AddSupervisor() {\r\n      const { data: res } = await this.$http.post(\r\n        `/api/supervise/`,\r\n        this.supervisorForm\r\n      );\r\n      if (res.success) {\r\n        this.addDialogVisible = false;\r\n        this.$message.success(res.message);\r\n        this.getSupervisorList(this.page, this.limit, this.queryInfo);\r\n      } else {\r\n        this.$message.error(res.message);\r\n      }\r\n    },\r\n    //修改督导信息表单验证\r\n    async doUpdate() {\r\n      await this.$refs.supervisorForm\r\n        .validate()\r\n        .then(() => {\r\n          this.UpdateSupervisor();\r\n          this.supervisorForm = this.$options.data().supervisorForm;\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n          this.$message.error(\"请检查督导信息！\");\r\n        });\r\n    },\r\n    //功能3：修改督导信息\r\n    async UpdateSupervisor(id) {\r\n      id = this.id;\r\n      const { data: res } = await this.$http.put(\r\n        `/api/supervise/${id}`,\r\n        this.supervisorForm\r\n      );\r\n      if (res.success) {\r\n        this.updateDialogVisible = false;\r\n        this.getSupervisorList(this.page, this.limit, this.queryInfo);\r\n        this.$message.success(res.message);\r\n      } else {\r\n        this.$message.error(res.message);\r\n      }\r\n    },\r\n    //展示修改信息对话框\r\n    showEditView(data) {\r\n      this.supervisorForm = data;\r\n      this.updateDialogVisible = true;\r\n      this.id = data.id;\r\n    },\r\n    //功能4：单条教师信息删除\r\n    async handleDelete(index, data) {\r\n      this.index = index;\r\n      const confirmResult = await this.$confirm(\r\n        \"此操作将永久删除 [ \" + data.name + \" ] 老师信息, 是否继续?\",\r\n        \"提示\",\r\n        {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\",\r\n          type: \"warning\",\r\n          center: true,\r\n        }\r\n      ).catch((err) => err);\r\n      if (confirmResult !== \"confirm\") {\r\n        return this.$message.info(\"已取消\");\r\n      }\r\n      const { data: res } = await this.$http.delete(\r\n        `/api/supervise/${data.id}`\r\n      );\r\n      if (res.success) {\r\n        this.$message.success(res.message);\r\n        this.getSupervisorList(this.page, this.limit, this.queryInfo);\r\n      } else {\r\n        this.$message.error(res.message);\r\n      }\r\n    },\r\n    //获取全部督导信息\r\n    async getSupervisorList(page = 1, limit, queryInfo) {\r\n      const { data: res } = await this.$http.post(\r\n        `/api/supervise/list/${page}/${limit}`,\r\n        queryInfo\r\n      );\r\n      this.supervisorlist = res.data.rows;\r\n      this.total = res.data.total;\r\n    },\r\n    //刷新\r\n    reload() {\r\n      location.reload();\r\n    },\r\n    //清空数据\r\n    cancelUpdate() {\r\n      this.updateDialogVisible = false;\r\n      this.supervisorForm = this.$options.data().supervisorForm;\r\n    },\r\n    cancelAdd() {\r\n      this.addDialogVisible = false;\r\n      this.supervisorForm = this.$options.data().supervisorForm;\r\n    },\r\n    //获取复选框行\r\n    handleSelectionChange(val) {\r\n      this.multipleSelection = val;\r\n    },\r\n    //分页器跳转\r\n    handleCurrentChange(val) {\r\n      this.page = val;\r\n      this.getSupervisorList(this.page, this.limit, this.queryInfo);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.bigContainer {\r\n  height: 670px;\r\n}\r\n.el-tabel,\r\n.el-tabel-column {\r\n  line-height: 70px;\r\n  text-align: center;\r\n}\r\n.el-input {\r\n  margin-right: 10px;\r\n}\r\n.sup_tag {\r\n  font-size: 20px;\r\n}\r\n</style>\r\n"]}]}